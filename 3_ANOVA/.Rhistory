stripchart(x~groups, vertical = TRUE)
# plot figure to summary the distribution of target data
plot(groups, x, las=1, xlab="", ylab="Body size (g)")
# plot figure to summary the distribution of target data
plot(groups, x, las=1, xlab="", ylab="Body size (g)",
at = c(1, 3, 5), width = 0.6, col="lightgray")
# plot figure to summary the distribution of target data
boxplot(x~groups, las=1, xlab="", ylab="Body size (g)",
at = c(1, 3, 5), width = 0.6, col="lightgray")
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.4, position = position_nudge(x = -0.2), fill="lightgray") +
geom_jitter(width = 0.1, position = position_nudge(x = 0.2), color="blue", alpha=0.7) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
rlang::last_trace()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(position = position_nudge(x = -0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = 0.2), color="blue", alpha=0.7) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="blue", alpha=0.7) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
geom_point(aes(x = 1, y = 10), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 2, y = 13), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 3, y = 14), color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
geom_point(aes(x = 0.8, y = 10), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 1.8, y = 13), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 2.8, y = 14), color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
set.seed(100)
# simulate data
# create 3 groups, each has 50 variables, with 3 different levels: low, medium, high
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
geom_point(aes(x = 0.8, y = 10), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 1.8, y = 13), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 2.8, y = 14), color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
# simulate data
# create 3 groups, each has 50 variables, with 3 different levels: low, medium, high
groups <- factor(rep(c("Low", "Medium", "High"), each = 50),
levels = c("Low", "Medium", "High"))
# create 3 normal distribution, with different mean, but same variance
x = c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
geom_point(aes(x = 0.8, y = 10), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 1.8, y = 13), color = "red", size = 3, shape = 18) +
geom_point(aes(x = 2.8, y = 14), color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate(aes(x = 0.8, y = 10), color = "red", size = 3, shape = 18) +
annotate(aes(x = 1.8, y = 13), color = "red", size = 3, shape = 18) +
annotate(aes(x = 2.8, y = 14), color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 13, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 14), color = "red", size = 3, shape = 18) +
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 13, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 14, color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
# fit linear model
m <-  lm(x~groups)
anova(m)
anova <- anova(m)
anova$`Sum Sq`
total_sum_sq <- sum(anova$`Sum Sq`)
total_sum_sq
Var_T <- total_sum_sq / (150 - 1)
anova_m <- anova(m)
total_sum_sq <- sum(anova$`Sum Sq`)
Var_T <- total_sum_sq / (150 - 1)
anova_m$`Sum Sq`[1]
anova_m$`Sum Sq`[1] / total_sum_sq
summary(m)
# simulate data
# create 3 groups, each has 50 variables, with 3 different levels: low, medium, high
groups <- factor(rep(c("Low", "Medium", "High"), each = 50))
# create 3 normal distribution, with different mean, but same variance
x <-  c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 13, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 14, color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
# fit linear model
m <-  lm(x~groups)
anova_m <- anova(m)
total_sum_sq <- sum(anova$`Sum Sq`)
Var_T <- total_sum_sq / (150 - 1)
summary(m)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 14, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 13, color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
summary(m)
# simulate data
# create 3 groups, each has 50 variables, with 3 different levels: low, medium, high
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
# create 3 normal distribution, with different mean, but same variance
x <-  c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 14, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 13, color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
# fit linear model
m <-  lm(x~groups)
anova_m <- anova(m)
total_sum_sq <- sum(anova$`Sum Sq`)
Var_T <- total_sum_sq / (150 - 1)
summary(m)
anova_m
set.seed(100)
# simulate data
# create 3 groups, each has 50 variables, with 3 different levels: low, medium, high
groups = as.factor(rep(c("Low", "Medium", "High"), each=50))
# create 3 normal distribution, with different mean, but same variance
x <-  c(rnorm(50, 10, 3), rnorm(50, 13, 3), rnorm(50, 14, 3))
# plot figure to summary the distribution of target data
library(ggplot2)
df <- data.frame(groups, x)
ggplot(df, aes(x = groups, y = x)) +
geom_boxplot(width = 0.25, position = position_nudge(x = 0.2), fill="lightgray") +
geom_jitter(position = position_nudge(x = -0.2), color="lightgrey", alpha=0.7) +
annotate("point" ,x = 0.8, y = 14, color = "red", size = 3, shape = 18) +
annotate("point", x = 1.8, y = 10, color = "red", size = 3, shape = 18) +
annotate("point", x = 2.8, y = 13, color = "red", size = 3, shape = 18) +
labs(x = "", y = "Body size (g)") +
theme_minimal()
# fit linear model
m <-  lm(x~groups)
summary(m)
anova_m <- anova(m)
total_sum_sq <- sum(anova$`Sum Sq`)
Var_T <- total_sum_sq / (150 - 1)
total_sum_sq <- sum(anova$`Sum Sq`)
anova_m
total_sum_sq <- sum(anova_m$`Sum Sq`)
Var_T <- total_sum_sq / (150 - 1)
summary(m)
dat = read.csv("Data/butterflies.csv")
names(dat)
View(dat)
head(dat)
table(dat$MaternalHost)
table(dat$LarvalHost)
# read csv and data preparation
dat <-  read.csv("Data/butterflies.csv")
names(dat)  # check the name of columns
# create factors
factorA <- factor(dat$LarvalHost)
factorB <- factor(dat$MaternalHost)
head(factorA)
levels(factorA)
#package preparation
library(ggplot2)
## data preparation
# read csv and data preparation
dat <-  read.csv("Data/butterflies.csv")
names(dat)  # check the name of columns
# create factors/predictors
factorA <- factor(dat$LarvalHost)
factorB <- factor(dat$MaternalHost)
# create response variable
responseA <- dat$DevelopmentTime
responseB <- dat$AdultWeight
responseC <- dat$GrowthRate
# create data.frame
dfA <- data.frame(factorA, factorB, responseA)
dfB <- data.frame(factorA, factorB, responseB)
dfC <- data.frame(factorA, factorB, responseC)
## Perform 2-way ANOVA
mA <-lm(responseA ~ factorA * factorB, data = dfA)
anova_mA <- anova(mA)
anova_mA
summary(anova_mA)
# draw figures
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean(DevelopmentTime, na.rm = TRUE),
se_time = sd(DevelopmentTime) / sqrt(n())
)
library(dplyr)
# draw figures
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean(DevelopmentTime, na.rm = TRUE),
se_time = sd(DevelopmentTime) / sqrt(n())
)
ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = "Development time",
color = "Maternal host plant",
title = "Larval developmental time depending on larval and maternal host plant",
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 14)
ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = "Development time",
color = "Maternal host plant",
title = "Larval developmental time depending on larval and maternal host plant",
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# main logic
analysis_and_plot <- function(response, dat, y_label, title) {
# generate linera regression model
form <- as.formula(paste(response, "~ LarvalHost * MaternalHost"))
model <- lm(formu, data = dat)
print(anova(model))
print(summary(model))
# create plot data
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean((.data[[response]]), na.rm = TRUE),
se_time = sd((.data[[response]])) / sqrt(n())
)
# plot figure
ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = y_label,
color = "Maternal host plant",
title = title,
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# save
filename <- paste0(response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
}
}
## data preparation
# read csv and data preparation
dat <-  read.csv("Data/butterflies.csv")
names(dat)  # check the name of columns
# create factors/predictors
factorA <- factor(dat$LarvalHost)
factorB <- factor(dat$MaternalHost)
# create response variable
responseA <- dat$DevelopmentTime
responseB <- dat$AdultWeight
responseC <- dat$GrowthRate
# create data.frame
dfA <- data.frame(factorA, factorB, responseA)
dfB <- data.frame(factorA, factorB, responseB)
dfC <- data.frame(factorA, factorB, responseC)
# mini tese
analysis_and_plot(DevelopmentTime, dat, DevelopmentTime, DevelopmentTime)
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# main logic
analysis_and_plot <- function(response, dat, y_label, title) {
# generate linera regression model
formula <- as.formula(paste(response, "~ LarvalHost * MaternalHost"))
model <- lm(formu, data = dat)
print(anova(model))
print(summary(model))
# create plot data
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean((.data[[response]]), na.rm = TRUE),
se_time = sd((.data[[response]])) / sqrt(n())
)
# plot figure
ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = y_label,
color = "Maternal host plant",
title = title,
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# save
filename <- paste0(response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
}
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# main logic
analysis_and_plot <- function(response, dat, y_label, title) {
# generate linera regression model
formu <- as.formula(paste(response, "~ LarvalHost * MaternalHost"))
model <- lm(formu, data = dat)
print(anova(model))
print(summary(model))
# create plot data
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean((.data[[response]]), na.rm = TRUE),
se_time = sd((.data[[response]])) / sqrt(n())
)
# plot figure
ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = y_label,
color = "Maternal host plant",
title = title,
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# save
filename <- paste0(response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
}
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# package preparation
library(ggplot2)
library(dplyr)
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# main logic
analysis_and_plot <- function(response, dat, y_label, title) {
# generate linera regression model
formu <- as.formula(paste(response, "~ LarvalHost * MaternalHost"))
model <- lm(formu, data = dat)
print(anova(model))
print(summary(model))
# create plot data
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean((.data[[response]]), na.rm = TRUE),
se_time = sd((.data[[response]])) / sqrt(n())
)
# plot figure
p <- ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = y_label,
color = "Maternal host plant",
title = title,
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# save
filename <- paste0(response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
}
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
# save
filename <- paste0("./Result/", response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
# main logic
analysis_and_plot <- function(response, dat, y_label, title) {
# generate linera regression model
formu <- as.formula(paste(response, "~ LarvalHost * MaternalHost"))
model <- lm(formu, data = dat)
print(anova(model))
print(summary(model))
# create plot data
plot_data <- dat %>%
group_by(LarvalHost, MaternalHost) %>%
summarise(
mean_time = mean((.data[[response]]), na.rm = TRUE),
se_time = sd((.data[[response]])) / sqrt(n())
)
# plot figure
p <- ggplot(plot_data, aes(x = LarvalHost,
y = mean_time,
color = MaternalHost,
group = MaternalHost)) +
geom_point(size = 3) +
geom_line(size = 1) +
geom_errorbar(aes(ymin = mean_time - se_time,
ymax = mean_time + se_time),
width = 0.15,
linewidth = 0.8) +
labs(
x = "Larval host plant",
y = y_label,
color = "Maternal host plant",
title = title,
subtitle = "Error bars = SE"
) +
theme_minimal(base_size = 16)
# save
filename <- paste0("./Result/", response, "_plot.png")
ggsave(filename, plot = p, width = 7, height = 5, dpi = 300)
}
# mini test
analysis_and_plot("DevelopmentTime", dat, "DevelopmentTime", "DevelopmentTime")
